<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>線形代数 解答</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', 'Yu Mincho', 'YuMincho', 'Hiragino Mincho ProN', serif;
            line-height: 2;
            color: #000;
            background: #fafafa;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 50px 60px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h1 {
            color: #000;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 1.8em;
            text-align: center;
        }

        h2 {
            color: #000;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }

        .problem {
            background: #fff;
            padding: 20px;
            margin: 30px 0;
            border: 1px solid #000;
        }

        .problem-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .step {
            background: #fff;
            padding: 20px;
            margin: 25px 0;
            border-left: 3px solid #000;
            padding-left: 25px;
        }

        .step-title {
            font-weight: bold;
            font-size: 1.05em;
            margin-bottom: 15px;
        }

        .formula {
            background: #fff;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            overflow-x: auto;
        }

        .explanation {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 2px solid #666;
            padding-left: 20px;
        }

        .answer-box {
            background: #fff;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #000;
        }

        .answer-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
        }

        .verification {
            background: #fff;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #666;
        }

        .verification-title {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .calculation {
            margin: 10px 0;
            padding: 10px;
            border-left: 2px solid #ccc;
            padding-left: 15px;
        }

        .note {
            background: #fff;
            padding: 12px;
            margin: 15px 0;
            border: 1px dashed #666;
            font-size: 0.95em;
        }

        p {
            margin: 10px 0;
            text-align: justify;
        }

        .solution-number {
            font-weight: bold;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>線形代数 問3 (2) 解答</h1>

        <div class="problem">
            <div class="problem-title">【問題】</div>
            <p>部分空間 $W = \text{Span}\left\{\begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix}, \begin{pmatrix} 1 \\ 1 \\ 3 \end{pmatrix}\right\}$ の直交基底をひと組求めよ。</p>
        </div>

        <h2>【解答】</h2>

        <div class="step">
            <div class="step-title">(1) 与えられたベクトルを確認します。</div>
            <p>部分空間 $W$ は、2つのベクトルによって生成される部分空間です。これらのベクトルを $\boldsymbol{v}_1$、$\boldsymbol{v}_2$ とします。</p>
            <div class="formula">
                $$\boldsymbol{v}_1 = \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix}, \quad \boldsymbol{v}_2 = \begin{pmatrix} 1 \\ 1 \\ 3 \end{pmatrix}$$
            </div>
            <p>これらのベクトルが線形独立であることを確認します。2つのベクトルが線形独立であるためには、一方が他方の定数倍でないことが必要です。$\boldsymbol{v}_1$ と $\boldsymbol{v}_2$ を比較すると、$\boldsymbol{v}_1$ の第1成分が $0$ であるのに対し、$\boldsymbol{v}_2$ の第1成分は $1$ であるため、一方が他方の定数倍ではないことが分かります。したがって、これらは線形独立です。</p>
            <div class="note">
                <p>線形独立なベクトルの組は部分空間の基底をなします。したがって、$\boldsymbol{v}_1$ と $\boldsymbol{v}_2$ は $W$ の基底です。</p>
            </div>
        </div>

        <div class="step">
            <div class="step-title">(2) Gram-Schmidtの直交化法を用いて直交基底を構成します。</div>
            <p>Gram-Schmidtの直交化法は、与えられた基底ベクトルから順に、既に求めた直交ベクトルへの正射影を引くことで、互いに直交するベクトルを構成する方法です。この方法により、元の部分空間と同じ部分空間を張る直交基底を得ることができます。</p>
            <p>最初の直交基底ベクトルを $\boldsymbol{u}_1 = \boldsymbol{v}_1$ とします。これは、最初のベクトルをそのまま使用することを意味します。</p>
            <div class="formula">
                $$\boldsymbol{u}_1 = \boldsymbol{v}_1 = \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix}$$
            </div>
            <p>次に、$\boldsymbol{v}_2$ から $\boldsymbol{u}_1$ への正射影を引いて、$\boldsymbol{u}_1$ に直交するベクトル $\boldsymbol{u}_2$ を求めます。正射影の公式を用いると、次のようになります。</p>
            <div class="formula">
                $$\boldsymbol{u}_2 = \boldsymbol{v}_2 - \frac{\boldsymbol{v}_2 \cdot \boldsymbol{u}_1}{\boldsymbol{u}_1 \cdot \boldsymbol{u}_1}\boldsymbol{u}_1$$
            </div>
            <p>この式は、$\boldsymbol{v}_2$ から $\boldsymbol{u}_1$ 方向の成分を除去することで、$\boldsymbol{u}_1$ に直交するベクトルを得ることを意味します。まず、必要な内積を計算します。</p>
            <div class="calculation">
                <p>$\boldsymbol{v}_2$ と $\boldsymbol{u}_1$ の内積を計算します。</p>
                <p>$\boldsymbol{v}_2 \cdot \boldsymbol{u}_1 = \begin{pmatrix} 1 \\ 1 \\ 3 \end{pmatrix} \cdot \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix} = 1 \cdot 0 + 1 \cdot (-1) + 3 \cdot 2 = 0 - 1 + 6 = 5$</p>
                <p>$\boldsymbol{u}_1$ のノルムの2乗を計算します。</p>
                <p>$\boldsymbol{u}_1 \cdot \boldsymbol{u}_1 = \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix} \cdot \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix} = 0^2 + (-1)^2 + 2^2 = 0 + 1 + 4 = 5$</p>
            </div>
            <p>これらの値を用いて、$\boldsymbol{u}_2$ を計算します。正射影の係数は $\frac{\boldsymbol{v}_2 \cdot \boldsymbol{u}_1}{\boldsymbol{u}_1 \cdot \boldsymbol{u}_1} = \frac{5}{5} = 1$ となります。</p>
            <div class="formula">
                $$\boldsymbol{u}_2 = \begin{pmatrix} 1 \\ 1 \\ 3 \end{pmatrix} - 1 \cdot \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix} = \begin{pmatrix} 1 \\ 1 \\ 3 \end{pmatrix} - \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix}$$
            </div>
            <p>ベクトルの差を計算します。</p>
            <div class="calculation">
                <p>$\boldsymbol{u}_2 = \begin{pmatrix} 1 - 0 \\ 1 - (-1) \\ 3 - 2 \end{pmatrix} = \begin{pmatrix} 1 \\ 2 \\ 1 \end{pmatrix}$</p>
            </div>
            <p>したがって、直交基底は次の通りです。</p>
            <div class="formula">
                $$\boldsymbol{u}_1 = \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix}, \quad \boldsymbol{u}_2 = \begin{pmatrix} 1 \\ 2 \\ 1 \end{pmatrix}$$
            </div>
        </div>

        <div class="step">
            <div class="step-title">(3) 直交性を確認します。</div>
            <p>求めた2つのベクトルが互いに直交することを確認します。2つのベクトルが直交するためには、それらの内積が $0$ である必要があります。</p>
            <div class="calculation">
                <p>$\boldsymbol{u}_1$ と $\boldsymbol{u}_2$ の内積を計算します。</p>
                <p>$\boldsymbol{u}_1 \cdot \boldsymbol{u}_2 = \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix} \cdot \begin{pmatrix} 1 \\ 2 \\ 1 \end{pmatrix} = 0 \cdot 1 + (-1) \cdot 2 + 2 \cdot 1 = 0 - 2 + 2 = 0$</p>
            </div>
            <p>内積が $0$ であるため、$\boldsymbol{u}_1$ と $\boldsymbol{u}_2$ は互いに直交しています。したがって、これらは直交基底をなします。</p>
            <div class="explanation">
                <p>直交基底とは、互いに直交するベクトルからなる基底です。求めた $\boldsymbol{u}_1$ と $\boldsymbol{u}_2$ は互いに直交し、かつ元の部分空間 $W$ を張るため、$W$ の直交基底となります。</p>
            </div>
        </div>

        <div class="answer-box">
            <div class="answer-title">【答え】</div>
            <p>部分空間 $W$ の直交基底は次の通りです。</p>
            <div class="formula">
                $$\boldsymbol{u}_1 = \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix}, \quad \boldsymbol{u}_2 = \begin{pmatrix} 1 \\ 2 \\ 1 \end{pmatrix}$$
            </div>
        </div>

        <div class="verification">
            <div class="verification-title">【検証】</div>
            <p>求めた結果が正しいことを確認します。2つの観点から検証します。</p>
            <p>まず、$\boldsymbol{u}_1$ と $\boldsymbol{u}_2$ が互いに直交することを再確認します。内積の計算により、$\boldsymbol{u}_1 \cdot \boldsymbol{u}_2 = 0$ であることが確認できました。これにより、2つのベクトルは互いに直交しています。</p>
            <div class="calculation">
                <p>$\boldsymbol{u}_1 \cdot \boldsymbol{u}_2 = 0 \cdot 1 + (-1) \cdot 2 + 2 \cdot 1 = 0 - 2 + 2 = 0$</p>
            </div>
            <p>次に、求めた直交基底が元の部分空間 $W$ を張ることを確認します。元のベクトル $\boldsymbol{v}_1$、$\boldsymbol{v}_2$ が、求めた直交基底 $\boldsymbol{u}_1$、$\boldsymbol{u}_2$ の線形結合で表せることを示します。これにより、$\text{Span}\{\boldsymbol{u}_1, \boldsymbol{u}_2\} = \text{Span}\{\boldsymbol{v}_1, \boldsymbol{v}_2\} = W$ であることが確認できます。</p>
            <p>$\boldsymbol{v}_1 = \boldsymbol{u}_1$ であるため、$\boldsymbol{v}_1$ は $\boldsymbol{u}_1$ の線形結合で表せます。$\boldsymbol{v}_2$ について、Gram-Schmidtの直交化法の過程から、$\boldsymbol{v}_2 = \boldsymbol{u}_2 + \frac{\boldsymbol{v}_2 \cdot \boldsymbol{u}_1}{\boldsymbol{u}_1 \cdot \boldsymbol{u}_1}\boldsymbol{u}_1$ という関係が成り立ちます。先ほど計算した値 $\frac{\boldsymbol{v}_2 \cdot \boldsymbol{u}_1}{\boldsymbol{u}_1 \cdot \boldsymbol{u}_1} = \frac{5}{5} = 1$ を用いると、$\boldsymbol{v}_2 = \boldsymbol{u}_2 + \boldsymbol{u}_1$ となります。</p>
            <div class="calculation">
                <p>$\boldsymbol{v}_2 = \boldsymbol{u}_1 + \boldsymbol{u}_2 = \begin{pmatrix} 0 \\ -1 \\ 2 \end{pmatrix} + \begin{pmatrix} 1 \\ 2 \\ 1 \end{pmatrix} = \begin{pmatrix} 0 + 1 \\ -1 + 2 \\ 2 + 1 \end{pmatrix} = \begin{pmatrix} 1 \\ 1 \\ 3 \end{pmatrix}$</p>
                <p>これは元のベクトル $\boldsymbol{v}_2$ と一致します。したがって、$\boldsymbol{v}_2$ は $\boldsymbol{u}_1$ と $\boldsymbol{u}_2$ の線形結合で表せます。</p>
            </div>
            <p>$\boldsymbol{v}_1$ と $\boldsymbol{v}_2$ の両方が $\boldsymbol{u}_1$ と $\boldsymbol{u}_2$ の線形結合で表せるため、$\text{Span}\{\boldsymbol{v}_1, \boldsymbol{v}_2\} \subset \text{Span}\{\boldsymbol{u}_1, \boldsymbol{u}_2\}$ が成り立ちます。逆に、$\boldsymbol{u}_1 = \boldsymbol{v}_1$ であり、$\boldsymbol{u}_2 = \boldsymbol{v}_2 - \boldsymbol{v}_1$ であるため、$\boldsymbol{u}_1$ と $\boldsymbol{u}_2$ は $\boldsymbol{v}_1$ と $\boldsymbol{v}_2$ の線形結合で表せます。したがって、$\text{Span}\{\boldsymbol{u}_1, \boldsymbol{u}_2\} \subset \text{Span}\{\boldsymbol{v}_1, \boldsymbol{v}_2\}$ も成り立ちます。これにより、$\text{Span}\{\boldsymbol{u}_1, \boldsymbol{u}_2\} = \text{Span}\{\boldsymbol{v}_1, \boldsymbol{v}_2\} = W$ であることが確認できます。</p>
            <p>以上より、求めた直交基底 $\boldsymbol{u}_1$、$\boldsymbol{u}_2$ は元の部分空間 $W$ を張り、かつ互いに直交するため、$W$ の直交基底であることが確認できました。また、$\boldsymbol{u}_1$ と $\boldsymbol{u}_2$ は線形独立であるため、これらは $W$ の基底でもあります。</p>
            <p>以上より求めた結果の正しさを確認しました。</p>
        </div>
    </div>
</body>
</html>
