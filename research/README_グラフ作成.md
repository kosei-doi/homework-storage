# 光と波動 実験2 - Excelグラフ作成スクリプト

このフォルダには、Excel上でグラフを作成するためのスクリプトが含まれています。

## ファイル一覧

1. **create_excel_graph_with_chart.py** - Excelファイル内に自動的にグラフを作成するスクリプト（推奨）
2. **create_excel_graph.py** - グラフ用データシートのみ作成するスクリプト（手動でグラフを作成したい場合）
3. **create_graph.py** - PNG形式でグラフを出力するスクリプト（画像ファイルとして保存）

## 使用方法

### 方法1: 自動グラフ作成（推奨）

```bash
python3 create_excel_graph_with_chart.py
```

このスクリプトは：
- 既存のExcelファイル（`光と波動_実験2_グラフ.xlsx`）からデータを読み込み
- グラフ用データシートを作成
- Excel内に直接グラフを作成
- `光と波動_実験2_グラフ_チャート付き.xlsx` として保存

出力ファイルには以下のシートが含まれます：
- **グラフ用データ**: グラフ作成用に整理されたデータ
- **グラフ**: 自動生成されたグラフ（3つの実験条件を重ねて表示）
- 元の実験シート（実験2-1_グラフ、実験2-2_グラフ、実験2-3_グラフ）

### 方法2: データシートのみ作成（手動でグラフを作成）

```bash
python3 create_excel_graph.py
```

このスクリプトはグラフ用データシートを作成しますが、グラフ自体は作成しません。
Excelで開いて手動でグラフを作成したい場合に使用します。

### 方法3: PNG画像として出力

```bash
python3 create_graph.py
```

このスクリプトはPNG形式の画像ファイルとしてグラフを保存します。

## 必要なライブラリ

```bash
pip install pandas openpyxl matplotlib
```

## グラフの特徴

- **横軸**: 角度 θ [degree] (0° ～ 180°)
- **縦軸**: 相対強度
- **3つの実験条件**:
  - 実験2-1: 偏光板2枚（青）
  - 実験2-2: 偏光板3枚 (α=0°)（赤）
  - 実験2-3: 偏光板3枚 (α=10°)（緑）
- 各実験条件について、**測定値**（実線）と**理論値**（破線）の両方を表示

## トラブルシューティング

### エラー: "No module named 'openpyxl'"

```bash
pip install openpyxl pandas
```

### エラー: "No module named 'pandas'"

```bash
pip install pandas
```

### Excelファイルが開けない

- ファイルが他のアプリケーションで開かれていないか確認
- ファイルパスが正しいか確認

## グラフのカスタマイズ

作成されたグラフは、Excelで開いて以下のようにカスタマイズできます：

1. **グラフタイトル**: グラフを選択 → グラフタイトルを編集
2. **軸ラベル**: 軸を選択 → 軸の書式設定
3. **凡例**: 凡例を選択 → 凡例の書式設定
4. **線のスタイル**: データ系列を選択 → 線の書式設定
5. **マーカーのスタイル**: データ系列を選択 → マーカーの書式設定

## 注意事項

- 元のExcelファイル（`光と波動_実験2_グラフ.xlsx`）は変更されません
- 新しいファイル（`光と波動_実験2_グラフ_チャート付き.xlsx`）が作成されます
- グラフ用データシートは、元のデータから自動的に生成されます

