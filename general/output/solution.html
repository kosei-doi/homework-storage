<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>線形代数 解答</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', 'Yu Mincho', 'YuMincho', 'Hiragino Mincho ProN', serif;
            line-height: 2;
            color: #000;
            background: #fafafa;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 50px 60px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h1 {
            color: #000;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 1.8em;
            text-align: center;
        }

        h2 {
            color: #000;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }

        .problem {
            background: #fff;
            padding: 20px;
            margin: 30px 0;
            border: 1px solid #000;
        }

        .problem-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .step {
            background: #fff;
            padding: 20px;
            margin: 25px 0;
            border-left: 3px solid #000;
            padding-left: 25px;
        }

        .step-title {
            font-weight: bold;
            font-size: 1.05em;
            margin-bottom: 15px;
        }

        .formula {
            background: #fff;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            overflow-x: auto;
        }

        .explanation {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 2px solid #666;
            padding-left: 20px;
        }

        .answer-box {
            background: #fff;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #000;
        }

        .answer-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
        }

        .verification {
            background: #fff;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #666;
        }

        .verification-title {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .calculation {
            margin: 10px 0;
            padding: 10px;
            border-left: 2px solid #ccc;
            padding-left: 15px;
        }

        .note {
            background: #fff;
            padding: 12px;
            margin: 15px 0;
            border: 1px dashed #666;
            font-size: 0.95em;
        }

        p {
            margin: 10px 0;
            text-align: justify;
        }

        .solution-number {
            font-weight: bold;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>線形代数 問12 (2) 解答</h1>

        <div class="problem">
            <div class="problem-title">【問題】</div>
            <p>次の対称行列を直交行列によって対角化せよ。</p>
            <div class="formula">
                $$A = \begin{pmatrix}
                9 & -2 \\
                -2 & 6
                \end{pmatrix}$$
            </div>
        </div>

        <h2>【解答】</h2>

        <div class="step">
            <div class="step-title">（1）固有値を求めます。</div>
            <p>特性方程式 $\det(A - \lambda I) = 0$ を解いて固有値を求めます。</p>
            <div class="formula">
                $$A - \lambda I = \begin{pmatrix}
                9 - \lambda & -2 \\
                -2 & 6 - \lambda
                \end{pmatrix}$$
            </div>
            <p>この行列の行列式を計算します。</p>
            <div class="calculation">
                $$\det(A - \lambda I) = (9 - \lambda)(6 - \lambda) - (-2)(-2)$$
                $$= 54 - 9\lambda - 6\lambda + \lambda^2 - 4$$
                $$= \lambda^2 - 15\lambda + 50$$
            </div>
            <p>特性方程式 $\lambda^2 - 15\lambda + 50 = 0$ を解きます。</p>
            <div class="calculation">
                $$\lambda^2 - 15\lambda + 50 = (\lambda - 5)(\lambda - 10) = 0$$
            </div>
            <p>したがって、固有値は $\lambda_1 = 5$、$\lambda_2 = 10$ です。</p>
            <div class="explanation">
                この行列は2×2の対称行列なので、定理6により固有値は実数であり、異なる固有値に属する固有ベクトルは直交します。
            </div>
        </div>

        <div class="step">
            <div class="step-title">（2）各固有値に対応する固有ベクトルを求めます。</div>
            
            <p>まず、$\lambda_1 = 5$ に対応する固有ベクトルを求めます。</p>
            <div class="formula">
                $$(A - 5I)\boldsymbol{v}_1 = \boldsymbol{0}$$
            </div>
            <div class="calculation">
                $$\begin{pmatrix}
                9 - 5 & -2 \\
                -2 & 6 - 5
                \end{pmatrix}\begin{pmatrix}
                x \\
                y
                \end{pmatrix} = \begin{pmatrix}
                4 & -2 \\
                -2 & 1
                \end{pmatrix}\begin{pmatrix}
                x \\
                y
                \end{pmatrix} = \begin{pmatrix}
                0 \\
                0
                \end{pmatrix}$$
            </div>
            <p>この連立方程式を解きます。</p>
            <div class="calculation">
                $$4x - 2y = 0$$
                $$-2x + y = 0$$
            </div>
            <p>第1式から $y = 2x$ が得られます。第2式も同じ関係式を与えます。</p>
            <p>したがって、$x = 1$ とすると $y = 2$ となり、$\boldsymbol{v}_1 = \begin{pmatrix} 1 \\ 2 \end{pmatrix}$ が固有ベクトルです（定数倍を除く）。</p>
            
            <p>次に、$\lambda_2 = 10$ に対応する固有ベクトルを求めます。</p>
            <div class="formula">
                $$(A - 10I)\boldsymbol{v}_2 = \boldsymbol{0}$$
            </div>
            <div class="calculation">
                $$\begin{pmatrix}
                9 - 10 & -2 \\
                -2 & 6 - 10
                \end{pmatrix}\begin{pmatrix}
                x \\
                y
                \end{pmatrix} = \begin{pmatrix}
                -1 & -2 \\
                -2 & -4
                \end{pmatrix}\begin{pmatrix}
                x \\
                y
                \end{pmatrix} = \begin{pmatrix}
                0 \\
                0
                \end{pmatrix}$$
            </div>
            <p>この連立方程式を解きます。</p>
            <div class="calculation">
                $$-x - 2y = 0$$
                $$-2x - 4y = 0$$
            </div>
            <p>第1式から $x = -2y$ が得られます。第2式も同じ関係式を与えます。</p>
            <p>したがって、$y = 1$ とすると $x = -2$ となり、$\boldsymbol{v}_2 = \begin{pmatrix} -2 \\ 1 \end{pmatrix}$ が固有ベクトルです（定数倍を除く）。</p>
            
            <div class="note">
                固有ベクトル $\boldsymbol{v}_1$ と $\boldsymbol{v}_2$ の内積を計算すると、$\boldsymbol{v}_1 \cdot \boldsymbol{v}_2 = 1 \cdot (-2) + 2 \cdot 1 = 0$ となり、確かに直交しています。これは定理6(b)により、異なる固有値に属する固有ベクトルは直交することを示しています。
            </div>
        </div>

        <div class="step">
            <div class="step-title">（3）固有ベクトルを正規化して直交行列を構成します。</div>
            <p>各固有ベクトルの長さを1に正規化します。</p>
            
            <p>$\boldsymbol{v}_1 = \begin{pmatrix} 1 \\ 2 \end{pmatrix}$ の長さは $|\boldsymbol{v}_1| = \sqrt{1^2 + 2^2} = \sqrt{5}$ です。</p>
            <p>したがって、正規化されたベクトルは</p>
            <div class="formula">
                $$\boldsymbol{q}_1 = \frac{1}{\sqrt{5}}\begin{pmatrix} 1 \\ 2 \end{pmatrix} = \begin{pmatrix} \frac{1}{\sqrt{5}} \\ \frac{2}{\sqrt{5}} \end{pmatrix}$$
            </div>
            
            <p>$\boldsymbol{v}_2 = \begin{pmatrix} -2 \\ 1 \end{pmatrix}$ の長さは $|\boldsymbol{v}_2| = \sqrt{(-2)^2 + 1^2} = \sqrt{5}$ です。</p>
            <p>したがって、正規化されたベクトルは</p>
            <div class="formula">
                $$\boldsymbol{q}_2 = \frac{1}{\sqrt{5}}\begin{pmatrix} -2 \\ 1 \end{pmatrix} = \begin{pmatrix} -\frac{2}{\sqrt{5}} \\ \frac{1}{\sqrt{5}} \end{pmatrix}$$
            </div>
            
            <p>これらの正規化された固有ベクトルを列ベクトルとして並べた行列が直交行列 $P$ です。</p>
            <div class="formula">
                $$P = \begin{pmatrix}
                \frac{1}{\sqrt{5}} & -\frac{2}{\sqrt{5}} \\
                \frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}$$
            </div>
            
            <div class="explanation">
                この行列 $P$ の列ベクトルは正規直交基底をなしているため、$P$ は直交行列です。直交行列の性質により、$P^{-1} = {}^tP$ が成り立ちます。
            </div>
        </div>

        <div class="step">
            <div class="step-title">（4）対角化を確認します。</div>
            <p>直交行列 $P$ によって $A$ が対角化されることを確認します。</p>
            
            <p>まず、$P$ の転置行列を計算します。</p>
            <div class="formula">
                $${}^tP = \begin{pmatrix}
                \frac{1}{\sqrt{5}} & \frac{2}{\sqrt{5}} \\
                -\frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}$$
            </div>
            
            <p>次に、${}^tPAP$ を計算して対角行列になることを確認します。</p>
            <div class="calculation">
                $${}^tPAP = \begin{pmatrix}
                \frac{1}{\sqrt{5}} & \frac{2}{\sqrt{5}} \\
                -\frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}\begin{pmatrix}
                9 & -2 \\
                -2 & 6
                \end{pmatrix}\begin{pmatrix}
                \frac{1}{\sqrt{5}} & -\frac{2}{\sqrt{5}} \\
                \frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}$$
            </div>
            
            <p>まず $AP$ を計算します。</p>
            <div class="calculation">
                $$AP = \begin{pmatrix}
                9 & -2 \\
                -2 & 6
                \end{pmatrix}\begin{pmatrix}
                \frac{1}{\sqrt{5}} & -\frac{2}{\sqrt{5}} \\
                \frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}$$
            </div>
            <p>第1列は $A\boldsymbol{q}_1$ を計算します。</p>
            <div class="calculation">
                $$A\boldsymbol{q}_1 = \begin{pmatrix}
                9 & -2 \\
                -2 & 6
                \end{pmatrix}\begin{pmatrix}
                \frac{1}{\sqrt{5}} \\
                \frac{2}{\sqrt{5}}
                \end{pmatrix} = \begin{pmatrix}
                \frac{9 - 4}{\sqrt{5}} \\
                \frac{-2 + 12}{\sqrt{5}}
                \end{pmatrix} = \begin{pmatrix}
                \frac{5}{\sqrt{5}} \\
                \frac{10}{\sqrt{5}}
                \end{pmatrix} = 5\begin{pmatrix}
                \frac{1}{\sqrt{5}} \\
                \frac{2}{\sqrt{5}}
                \end{pmatrix} = 5\boldsymbol{q}_1$$
            </div>
            <p>第2列は $A\boldsymbol{q}_2$ を計算します。</p>
            <div class="calculation">
                $$A\boldsymbol{q}_2 = \begin{pmatrix}
                9 & -2 \\
                -2 & 6
                \end{pmatrix}\begin{pmatrix}
                -\frac{2}{\sqrt{5}} \\
                \frac{1}{\sqrt{5}}
                \end{pmatrix} = \begin{pmatrix}
                \frac{-18 - 2}{\sqrt{5}} \\
                \frac{4 + 6}{\sqrt{5}}
                \end{pmatrix} = \begin{pmatrix}
                -\frac{20}{\sqrt{5}} \\
                \frac{10}{\sqrt{5}}
                \end{pmatrix} = 10\begin{pmatrix}
                -\frac{2}{\sqrt{5}} \\
                \frac{1}{\sqrt{5}}
                \end{pmatrix} = 10\boldsymbol{q}_2$$
            </div>
            <p>したがって、</p>
            <div class="formula">
                $$AP = \begin{pmatrix}
                5\boldsymbol{q}_1 & 10\boldsymbol{q}_2
                \end{pmatrix} = \begin{pmatrix}
                \frac{5}{\sqrt{5}} & -\frac{20}{\sqrt{5}} \\
                \frac{10}{\sqrt{5}} & \frac{10}{\sqrt{5}}
                \end{pmatrix}$$
            </div>
            
            <p>次に ${}^tP(AP)$ を計算します。</p>
            <div class="calculation">
                $${}^tP(AP) = \begin{pmatrix}
                \frac{1}{\sqrt{5}} & \frac{2}{\sqrt{5}} \\
                -\frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}\begin{pmatrix}
                \frac{5}{\sqrt{5}} & -\frac{20}{\sqrt{5}} \\
                \frac{10}{\sqrt{5}} & \frac{10}{\sqrt{5}}
                \end{pmatrix}$$
            </div>
            <p>各成分を計算します。</p>
            <div class="calculation">
                $(1,1)$ 成分: $\frac{1}{\sqrt{5}} \cdot \frac{5}{\sqrt{5}} + \frac{2}{\sqrt{5}} \cdot \frac{10}{\sqrt{5}} = \frac{5 + 20}{5} = 5$<br>
                $(1,2)$ 成分: $\frac{1}{\sqrt{5}} \cdot \left(-\frac{20}{\sqrt{5}}\right) + \frac{2}{\sqrt{5}} \cdot \frac{10}{\sqrt{5}} = \frac{-20 + 20}{5} = 0$<br>
                $(2,1)$ 成分: $-\frac{2}{\sqrt{5}} \cdot \frac{5}{\sqrt{5}} + \frac{1}{\sqrt{5}} \cdot \frac{10}{\sqrt{5}} = \frac{-10 + 10}{5} = 0$<br>
                $(2,2)$ 成分: $-\frac{2}{\sqrt{5}} \cdot \left(-\frac{20}{\sqrt{5}}\right) + \frac{1}{\sqrt{5}} \cdot \frac{10}{\sqrt{5}} = \frac{40 + 10}{5} = 10$
            </div>
            <p>したがって、</p>
            <div class="formula">
                $${}^tPAP = \begin{pmatrix}
                5 & 0 \\
                0 & 10
                \end{pmatrix}$$
            </div>
            
            <p>したがって、${}^tPAP = \begin{pmatrix} 5 & 0 \\ 0 & 10 \end{pmatrix}$ となり、対角行列が得られました。対角成分は固有値 $\lambda_1 = 5$ と $\lambda_2 = 10$ に対応しています。</p>
            
            <div class="answer-box">
                <div class="answer-title">【答え】</div>
                <p>直交行列</p>
                <div class="formula">
                    $$P = \begin{pmatrix}
                    \frac{1}{\sqrt{5}} & -\frac{2}{\sqrt{5}} \\
                    \frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                    \end{pmatrix}$$
                </div>
                <p>によって、</p>
                <div class="formula">
                    $${}^tPAP = \begin{pmatrix}
                    5 & 0 \\
                    0 & 10
                    \end{pmatrix}$$
                </div>
                <p>と対角化されます。</p>
            </div>
        </div>

        <div class="verification">
            <div class="verification-title">【検証】</div>
            <p>求めた結果の正しさを確認します。</p>
            
            <p>まず、$P$ が直交行列であることを確認します。直交行列の定義により、${}^tPP = I$ が成り立つことを確認します。</p>
            <div class="calculation">
                $${}^tPP = \begin{pmatrix}
                \frac{1}{\sqrt{5}} & \frac{2}{\sqrt{5}} \\
                -\frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}\begin{pmatrix}
                \frac{1}{\sqrt{5}} & -\frac{2}{\sqrt{5}} \\
                \frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}$$
                $$= \begin{pmatrix}
                \frac{1 + 4}{5} & \frac{-2 + 2}{5} \\
                \frac{-2 + 2}{5} & \frac{4 + 1}{5}
                \end{pmatrix} = \begin{pmatrix}
                1 & 0 \\
                0 & 1
                \end{pmatrix} = I$$
            </div>
            <p>したがって、$P$ は確かに直交行列です。</p>
            
            <p>次に、固有値と固有ベクトルの関係 $A\boldsymbol{q}_i = \lambda_i\boldsymbol{q}_i$ を直接確認します。これは、正規化された固有ベクトルが実際に固有値に対応する固有ベクトルであることを示します。</p>
            <div class="calculation">
                $$A\boldsymbol{q}_1 = \begin{pmatrix}
                9 & -2 \\
                -2 & 6
                \end{pmatrix}\begin{pmatrix}
                \frac{1}{\sqrt{5}} \\
                \frac{2}{\sqrt{5}}
                \end{pmatrix} = \begin{pmatrix}
                \frac{9 - 4}{\sqrt{5}} \\
                \frac{-2 + 12}{\sqrt{5}}
                \end{pmatrix} = \begin{pmatrix}
                \frac{5}{\sqrt{5}} \\
                \frac{10}{\sqrt{5}}
                \end{pmatrix} = 5\begin{pmatrix}
                \frac{1}{\sqrt{5}} \\
                \frac{2}{\sqrt{5}}
                \end{pmatrix} = 5\boldsymbol{q}_1$$
            </div>
            <div class="calculation">
                $$A\boldsymbol{q}_2 = \begin{pmatrix}
                9 & -2 \\
                -2 & 6
                \end{pmatrix}\begin{pmatrix}
                -\frac{2}{\sqrt{5}} \\
                \frac{1}{\sqrt{5}}
                \end{pmatrix} = \begin{pmatrix}
                \frac{-18 - 2}{\sqrt{5}} \\
                \frac{4 + 6}{\sqrt{5}}
                \end{pmatrix} = \begin{pmatrix}
                -\frac{20}{\sqrt{5}} \\
                \frac{10}{\sqrt{5}}
                \end{pmatrix} = 10\begin{pmatrix}
                -\frac{2}{\sqrt{5}} \\
                \frac{1}{\sqrt{5}}
                \end{pmatrix} = 10\boldsymbol{q}_2$$
            </div>
            <p>これにより、$\boldsymbol{q}_1$ と $\boldsymbol{q}_2$ がそれぞれ固有値 $5$ と $10$ に対応する固有ベクトルであることが確認できました。</p>
            
            <p>最後に、対角化の結果 ${}^tPAP = \begin{pmatrix} 5 & 0 \\ 0 & 10 \end{pmatrix}$ が正しいことを、逆変換 $P({}^tPAP){}^tP = A$ を計算して確認します。</p>
            <div class="calculation">
                $$P({}^tPAP){}^tP = \begin{pmatrix}
                \frac{1}{\sqrt{5}} & -\frac{2}{\sqrt{5}} \\
                \frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}\begin{pmatrix}
                5 & 0 \\
                0 & 10
                \end{pmatrix}\begin{pmatrix}
                \frac{1}{\sqrt{5}} & \frac{2}{\sqrt{5}} \\
                -\frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}$$
                $$= \begin{pmatrix}
                \frac{5}{\sqrt{5}} & -\frac{20}{\sqrt{5}} \\
                \frac{10}{\sqrt{5}} & \frac{10}{\sqrt{5}}
                \end{pmatrix}\begin{pmatrix}
                \frac{1}{\sqrt{5}} & \frac{2}{\sqrt{5}} \\
                -\frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
                \end{pmatrix}$$
                $$= \begin{pmatrix}
                \frac{5 + 40}{5} & \frac{10 - 20}{5} \\
                \frac{10 - 20}{5} & \frac{20 + 10}{5}
                \end{pmatrix} = \begin{pmatrix}
                9 & -2 \\
                -2 & 6
                \end{pmatrix} = A$$
            </div>
            <p>これにより、対角化の結果が正しく、元の行列 $A$ に戻ることが確認できました。</p>
            
            <p>以上より求めた結果の正しさを確認しました。</p>
        </div>
    </div>
</body>
</html>

