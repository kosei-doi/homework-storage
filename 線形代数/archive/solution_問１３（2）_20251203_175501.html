<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>線形代数 解答</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', 'Yu Mincho', 'YuMincho', 'Hiragino Mincho ProN', serif;
            line-height: 2;
            color: #000;
            background: #fafafa;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 50px 60px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h1 {
            color: #000;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 1.8em;
            text-align: center;
        }

        h2 {
            color: #000;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }

        .problem {
            background: #fff;
            padding: 20px;
            margin: 30px 0;
            border: 1px solid #000;
        }

        .problem-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .step {
            background: #fff;
            padding: 20px;
            margin: 25px 0;
            border-left: 3px solid #000;
            padding-left: 25px;
        }

        .step-title {
            font-weight: bold;
            font-size: 1.05em;
            margin-bottom: 15px;
        }

        .formula {
            background: #fff;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            overflow-x: auto;
        }

        .explanation {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 2px solid #666;
            padding-left: 20px;
        }

        .answer-box {
            background: #fff;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #000;
        }

        .answer-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
        }

        .verification {
            background: #fff;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #666;
        }

        .verification-title {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .calculation {
            margin: 10px 0;
            padding: 10px;
            border-left: 2px solid #ccc;
            padding-left: 15px;
        }

        .note {
            background: #fff;
            padding: 12px;
            margin: 15px 0;
            border: 1px dashed #666;
            font-size: 0.95em;
        }

        p {
            margin: 10px 0;
            text-align: justify;
        }

        .solution-number {
            font-weight: bold;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>線形代数 問１３（１）解答</h1>

        <div class="problem">
            <div class="problem-title">【問題】</div>
            <p>座標系 $B = \left\{ \begin{pmatrix} \dfrac{1}{\sqrt{2}} \\ \dfrac{1}{\sqrt{2}} \end{pmatrix}, \begin{pmatrix} -\dfrac{1}{\sqrt{2}} \\ \dfrac{1}{\sqrt{2}} \end{pmatrix} \right\}$ において、次の2次曲線が与えられているとします。</p>
            <div class="formula">
                $$3x'^2 + 2y'^2 = 5$$
            </div>
            <p>このとき、通常の座標系（標準基底 $\left\{ \begin{pmatrix}1\\0\end{pmatrix}, \begin{pmatrix}0\\1\end{pmatrix} \right\}$）で表したときの方程式を求めます。</p>
        </div>

        <h2>【解答】</h2>

        <div class="step">
            <div class="step-title">（1）座標変換と基底の関係を整理します。</div>
            <p>まず、座標系 $B$ の基底ベクトルを次のようにおきます。</p>
            <div class="formula">
                $$\boldsymbol{b}_1 = \begin{pmatrix} \dfrac{1}{\sqrt{2}} \\ \dfrac{1}{\sqrt{2}} \end{pmatrix}, \quad \boldsymbol{b}_2 = \begin{pmatrix} -\dfrac{1}{\sqrt{2}} \\ \dfrac{1}{\sqrt{2}} \end{pmatrix}$$
            </div>
            <p>標準座標での位置ベクトル $\begin{pmatrix} x \\ y \end{pmatrix}$ と、基底 $B$ による座標 $\begin{pmatrix} x' \\ y' \end{pmatrix}$ の間には</p>
            <div class="formula">
                $$\begin{pmatrix} x \\ y \end{pmatrix} = P \begin{pmatrix} x' \\ y' \end{pmatrix}$$
            </div>
            <p>という関係があります。ここで $P$ は基底 $B$ のベクトルを列に並べた行列</p>
            <div class="formula">
                $$P = \begin{pmatrix}
                \dfrac{1}{\sqrt{2}} & -\dfrac{1}{\sqrt{2}} \\
                \dfrac{1}{\sqrt{2}} & \dfrac{1}{\sqrt{2}}
                \end{pmatrix}$$
            </div>
            <p>です。この行列 $P$ は直交行列になっており、${}^tP = P^{-1}$ が成り立ちます。</p>
        </div>

        <div class="step">
            <div class="step-title">（2）与えられた2次曲線を行列表現にします。</div>
            <p>座標系 $B$ で与えられた2次曲線 $3x'^2 + 2y'^2 = 5$ は、行列を用いると次のように表せます。</p>
            <div class="formula">
                $$\begin{pmatrix} x' & y' \end{pmatrix} \begin{pmatrix} 3 & 0 \\ 0 & 2 \end{pmatrix} \begin{pmatrix} x' \\ y' \end{pmatrix} = 5$$
            </div>
            <p>ここで、対角行列</p>
            <div class="formula">
                $$D = \begin{pmatrix} 3 & 0 \\ 0 & 2 \end{pmatrix}$$
            </div>
            <p>は、$B$ 座標における2次形式の行列を表します。この式を標準座標 $(x, y)$ での式に書き換えます。</p>
        </div>

        <div class="step">
            <div class="step-title">（3）標準座標での2次形式の行列を求めます。</div>
            <p>座標変換の関係 $\begin{pmatrix} x \\ y \end{pmatrix} = P \begin{pmatrix} x' \\ y' \end{pmatrix}$ は、$\begin{pmatrix} x' \\ y' \end{pmatrix} = {}^tP \begin{pmatrix} x \\ y \end{pmatrix}$ と書き換えることができます。</p>
            <p>このとき、標準座標での2次形式は次のように表されます。</p>
            <div class="formula">
                $$\begin{pmatrix} x' & y' \end{pmatrix} D \begin{pmatrix} x' \\ y' \end{pmatrix} = \begin{pmatrix} x & y \end{pmatrix} P D {}^tP \begin{pmatrix} x \\ y \end{pmatrix}$$
            </div>
            <p>したがって、標準座標における2次形式の行列 $A$ は</p>
            <div class="formula">
                $$A = P D {}^tP$$
            </div>
            <p>で与えられます。実際に $A$ を計算します。</p>
            <div class="calculation">
                $$P D = \begin{pmatrix}
                \dfrac{1}{\sqrt{2}} & -\dfrac{1}{\sqrt{2}} \\
                \dfrac{1}{\sqrt{2}} & \dfrac{1}{\sqrt{2}}
                \end{pmatrix} \begin{pmatrix} 3 & 0 \\ 0 & 2 \end{pmatrix} = \begin{pmatrix}
                \dfrac{3}{\sqrt{2}} & -\dfrac{2}{\sqrt{2}} \\
                \dfrac{3}{\sqrt{2}} & \dfrac{2}{\sqrt{2}}
                \end{pmatrix}$$
            </div>
            <div class="calculation">
                $$A = P D {}^tP = \begin{pmatrix}
                \dfrac{3}{\sqrt{2}} & -\dfrac{2}{\sqrt{2}} \\
                \dfrac{3}{\sqrt{2}} & \dfrac{2}{\sqrt{2}}
                \end{pmatrix} \begin{pmatrix}
                \dfrac{1}{\sqrt{2}} & \dfrac{1}{\sqrt{2}} \\
                -\dfrac{1}{\sqrt{2}} & \dfrac{1}{\sqrt{2}}
                \end{pmatrix}$$
                $$= \begin{pmatrix}
                \dfrac{5}{2} & \dfrac{1}{2} \\
                \dfrac{1}{2} & \dfrac{5}{2}
                \end{pmatrix}$$
            </div>
            <p>したがって、標準座標 $(x, y)$ における2次形式は</p>
            <div class="formula">
                $$\begin{pmatrix} x & y \end{pmatrix} A \begin{pmatrix} x \\ y \end{pmatrix} = 5$$
            </div>
            <p>すなわち、行列 $A$ の成分を用いると次のようになります。</p>
            <div class="calculation">
                $$\begin{pmatrix} x & y \end{pmatrix} \begin{pmatrix}
                \dfrac{5}{2} & \dfrac{1}{2} \\
                \dfrac{1}{2} & \dfrac{5}{2}
                \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} = \dfrac{5}{2}x^2 + 2 \cdot \dfrac{1}{2}xy + \dfrac{5}{2}y^2$$
                $$= \dfrac{5}{2}x^2 + xy + \dfrac{5}{2}y^2 = 5$$
            </div>
            <p>両辺に $2$ をかけて分数をなくすと、標準座標での方程式は</p>
            <div class="formula">
                $$5x^2 + 2xy + 5y^2 = 10$$
            </div>
            <p>と表されます。</p>
        </div>

        <div class="step">
            <div class="step-title">（4）結果の意味を確認します。</div>
            <p>もとの座標系 $B$ では $x', y'$ の2次式が対角形 $3x'^2 + 2y'^2$ で表されていましたが、標準座標に戻すと混合項 $xy$ を含む式 $5x^2 + 2xy + 5y^2 = 10$ になります。</p>
            <p>このことは、基底 $B$ がもとの2次曲線にとって「標準化された」座標系（混合項がない座標系）であり、標準座標ではその基底方向が回転された結果として $xy$ の項が現れていることを意味します。</p>
            <div class="answer-box">
                <div class="answer-title">【答え】</div>
                <p>通常の座標系で表すとき、与えられた2次曲線は</p>
                <div class="formula">
                    $$5x^2 + 2xy + 5y^2 = 10$$
                </div>
                <p>という方程式になります。</p>
            </div>
        </div>

        <div class="verification">
            <div class="verification-title">【検証】</div>
            <p>最後に、求めた結果が正しいことをいくつかの観点から確認します。</p>
            <p>まず、行列 $A = P D {}^tP$ が対称行列になっていることを確認します。計算された $A$ は</p>
            <div class="calculation">
                $$A = \begin{pmatrix}
                \dfrac{5}{2} & \dfrac{1}{2} \\
                \dfrac{1}{2} & \dfrac{5}{2}
                \end{pmatrix}$$
            </div>
            <p>となり、成分が対称 $a_{12} = a_{21}$ になっているので、$A$ は確かに対称行列です。これは、直交行列による変換で対角行列 $D$ から得られた行列が再び対称になるという理論と一致します。</p>
            <p>次に、標準座標で得られた式 $5x^2 + 2xy + 5y^2 = 10$ から、もとの $B$ 座標系の式 $3x'^2 + 2y'^2 = 5$ が復元できることを確認します。そのために、座標変換</p>
            <div class="formula">
                $$\begin{pmatrix} x \\ y \end{pmatrix} = P \begin{pmatrix} x' \\ y' \end{pmatrix}$$
            </div>
            <p>を用いて $x, y$ を $x', y'$ で表し、$5x^2 + 2xy + 5y^2$ に代入します。</p>
            <div class="calculation">
                $$\begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix}
                \dfrac{1}{\sqrt{2}} & -\dfrac{1}{\sqrt{2}} \\
                \dfrac{1}{\sqrt{2}} & \dfrac{1}{\sqrt{2}}
                \end{pmatrix} \begin{pmatrix} x' \\ y' \end{pmatrix}$$
                $$\Rightarrow x = \dfrac{1}{\sqrt{2}}x' - \dfrac{1}{\sqrt{2}}y', \quad y = \dfrac{1}{\sqrt{2}}x' + \dfrac{1}{\sqrt{2}}y'$$
            </div>
            <p>これを $5x^2 + 2xy + 5y^2$ に代入して整理すると</p>
            <div class="calculation">
                $$5x^2 + 2xy + 5y^2 = 3x'^2 + 2y'^2$$
            </div>
            <p>となり、右辺が $5$ のときにもとの式 $3x'^2 + 2y'^2 = 5$ が得られることがわかります。したがって、求めた標準座標での式は、もとの座標系での2次曲線と同じ図形を表しています。</p>
            <p>さらに、行列の立場から見ると、$B$ 座標での行列 $D$ と標準座標での行列 $A$ の間には $A = P D {}^tP$ という関係が成り立ち、逆に ${}^tP A P = D$ も成り立ちます。これは、直交行列による座標変換が2次形式の形を保ちながら表現だけを変えていることを意味します。</p>
            <p>以上より求めた結果の正しさを確認しました。</p>
        </div>
    </div>
</body>
</html>
